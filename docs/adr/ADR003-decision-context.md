# ADR003: Decision Context

### Status
Accepted

---

### Context
OPA decision log는 정책(policy)과 룰(rule)을 기준으로 구조화되어 있다.

하지만 운영 디버깅에서는, 하나의 접근 요청을 기준으로 여러 정책의 판단 결과를
한 번에 파악할 필요가 있었다.

이때 재배치를 어디에서 수행할지에 대한 선택이 필요

---

### Decision
로그를 그대로 저장한 뒤, 서버에서 요청 단위의 Context를 구성하는 방식을 선택

- 원본 decision log는 보존
- 조회 시점에 요청 기준으로 판단 결과를 재배치
- 프론트엔드는 재배치된 결과를 그대로 표현

정책 평가 로직은 OPA에 그대로 두고, 서버는 결과를 해석하고 묶는 역할만 수행

---

### Consequences
- 원본 로그와 재배치된 Context를 분리할 수 있다.
- 재배치 기준을 서버에서 일관되게 관리할 수 있다.
- 조회 시점에 약간의 가공 비용이 발생한다.
